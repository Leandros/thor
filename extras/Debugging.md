# Debugging Crashes

This document documents multiple ways of debugging a crash, with or without
minidumps.

## Setup Symbols

To ease the process of symbol loading, copying the symbols to the binary
directory is the easiest solution:

- Copy symbols to binary directory
    - Copy `game.pdb`
    - Copy `gdll.pdb`
    - Copy `gdll.pdb` to `gdll_hotreload.pdb`

You should now have three additional files, `game.pdb`, `gdll.pdb` and `gdll_hotreload.pdb`.


## Using Minidumps

**Using dumpchk.exe:**

With `dumpchk.exe` the minidump files can be examined and verified.
Invoking (assuming you're in the root of the project directory)

    dumpchk.exe -y "srv*c:\cache*http://msdl.microsoft.com/download/symbols;_install\symbols" path/to/mini.dmp

will print useful information about the minidump.

**Using windbg.exe:**

- Open windbg.exe
- Open crash dump via File -> Open Crash Dump
- Set symbol path:
    - `.sympath srv*c:\cache*http://msdl.microsoft.com/download/symbols`
    - `.sympath+ path\to\binary\dir`
    - `.reload -i`
- Hit `k` to see the backtrace


## Using Crash Report offsets

To turn program offsets, generated by the crash report into real function names
you can do the following:

- Open windbg.exe
- Open executable via File -> Open Executable
- Set symbol path:
    - `.sympath srv*c:\cache*http://msdl.microsoft.com/download/symbols`
    - `.reload -i`
- `g` (short for go)
- The game is now running

You now have multiple options:

- Play till crash, hit `k` for backtrace
- `ln <addr>` to show the function name for an address
- `u <addr>` to show disassembly at the address
- `.open -a <addr>` to open the source browser at the address location


## Symbol Path

The symbol path consists of multiple paths, separated by a semicolon.
Use

    srv*c:\cache*http://msdl.microsoft.com/download/symbols

as MicroSoft's default symbol path.
Read more here: https://msdn.microsoft.com/en-us/library/windows/hardware/ff558829.aspx


## Windbg Cheat Sheet


More here: http://windbg.info/doc/1-common-cmds.html


## Links

http://stackoverflow.com/questions/30019889/how-to-set-up-symbols-in-windbg
https://msdn.microsoft.com/en-us/library/windows/hardware/dn745911%28v=vs.85%29.aspx?f=255&MSPPError=-2147217396
https://msdn.microsoft.com/en-us/library/windows/hardware/ff539042(v=vs.85).aspx

